<!DOCTYPE html>
	<html lang="it">
		<head>
			<title> Update Profile </title>
			<meta charset="UTF-8">

			<meta name="viewport" content="width=device-width,initial-scale=1.0">
			<link rel="stylesheet" href="bootstrap/css/bootstrap.css">
			<link rel=stylesheet href="css_pages/main_styles.css" type="text/css">
            <link rel=stylesheet href="css_pages/edit.css" type="text/css">
			<link rel="preconnect" href="https://fonts.googleapis.com">
			<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	        <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,400;0,500;1,100;1,700&display=swap" rel="stylesheet">
			<script type="module" src="./js/function_accesso.js"></script>
			<script type="module" src="./js/function_profile.js"></script>

		</head>
        <body class="bg-edit">
            <div class="grid-main">

                <div class="box-header">
                    <div class="box-header-left">
                        <span class="title-bold">BEE</span>
                        <span>TEAM</span>
                    </div>
                    <div class="box-header-center">
                        <img class="image-logo" alt="Qries" src="css_pages/images/Logoproject2.png">
                    </div>
                    <div class="box-header-right">
                        <a href="bacheca.html">
                            <button type="submit" class="btn btn-light;"> Bacheca </button>
                        </a>
                        <a class="active" href="profilo.html">
                             <button type="submit" class="btn btn-light;"> Profilo </button>
                        </a>
                        <button type="submit" id="logout_edit" class="btn btn-light; red-butt" > Sign Out </button>
                    </div>
                </div>

                <div class="grid-edit">
                    <div class="box-center-edit">
                        <div class="col-sm" id="space_info">
                            <div class="row">
                                <h1> Update Profile </h1>
                            </div>
                            <br>
                            <div class="row">
                                <label class="custom-control-label; text-warning"  for="nome_edit"> Name </label>
                                <input class="border-1 rounded" type="text" id="nome_edit" class="text-warning bg-dark; text-left" id="cprof"></span>  
                            </div>
                            <br>
                            <div class="row">
                                <label class="custom-control-label; text-warning"  for="cognome_edit"> Surname </label>
                                <input class="border-1 rounded" type="text" id="cognome_edit" class="text-warning bg-dark; text-left" id="cprof"></span>  
                            </div>
                            <br>
                            <div class="row">
                                <label class="custom-control-label; text-warning"  for="numero_edit"> Phone Number </label>
                                <input class="border-1 rounded" type="number" id="numero_edit">
                            </div>
                            <br>
                            <div class="row">
                                <label class="custom-control-label; text-warning"  for="email_edit"> Email </label>
                                <input class="border-1 rounded" type="email" id="email_edit">
                            </div>
                            <br><br><br>
                            <div class="row">
                                <label class="custom-control-label; text-warning"  for="password_edit_vecchia"> Old Password </label>
                                <input class="border-1 rounded" type="password" id="password_edit_vecchia">
                            </div>
                            <br>
                            <div class="row">
                                <label class="custom-control-label; text-warning"  for="password_edit_nuova"> New Password </label>
                                <input class="border-1 rounded" type="password" id="password_edit_nuova">
                            </div>
                            <div class="row; weigth:20px; text-center ; height:15px;" >
                                <a href="profilo.html">
                                    <button type="submit" id="edit_page"  class="btn btn-light btn-sm;">Save</button>
                                </a>
                            </div>
                            <br><br>
                            <div class="row; weigth:20px; text-right ; height:15px;" >
                                <button type="submit" id="delete_user"  class="btn btn-light btn-sm; red-butt">Delete Account</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="box-footer">
                    <h3>@BeeTea inc.</h3>
                </div>

            </div>
            


            <script type="module">
                import {updatePass,updateUser,update_email,delUser,saveInfo} from "./js/function_edit.js";
                import {getUser,sendEmail} from "./js/function_accesso.js";
                import {saveData,sign_Out} from "./js/function_profile.js";

                import { getAuth,updatePassword, updateEmail, signOut, createUserWithEmailAndPassword, signInWithEmailAndPassword,onAuthStateChanged , sendEmailVerification} from "https://www.gstatic.com/firebasejs/9.6.3/firebase-auth.js";

                var CurrentUser=null,user=null;
                let nome=document.getElementById("nome_edit");
                let cognome=document.getElementById("cognome_edit");

                let numero=document.getElementById("numero_edit");
                let email=document.getElementById("email_edit");
                let vecchia=document.getElementById("password_edit_vecchia");
                let nuova=document.getElementById("password_edit_nuova");

                let invia=document.getElementById("edit_page");
                let del=document.getElementById("delete_user");
                let log_out=document.getElementById("logout_edit");
                
                log_out.addEventListener('click',sign_Out);
                invia.addEventListener('click',function(){saveInfo(nome,cognome,numero,nuova,vecchia,email)});
                del.addEventListener('click',function(){delUser(CurrentUser.user,CurrentUser.email)});

                window.onload=function() {
			    CurrentUser=getUser();
				if(CurrentUser==null){
					alert("Non hai effettuato l'accesso!");
					window.location="accesso.html";

				}
				else{
					nome.setAttribute("placeholder",CurrentUser.nome);
                    cognome.setAttribute("placeholder",CurrentUser.cognome);
                    numero.setAttribute("placeholder",CurrentUser.numero);
					email.setAttribute("placeholder",CurrentUser.email);
				}
            }
            </script>
        </body>